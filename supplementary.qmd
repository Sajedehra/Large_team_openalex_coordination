---
title: "The Benefits and Motivations Behind Large-Team Coordination in Psychology - Supplementary Materials"
author:
  - name: Sajedeh Rasti
    corresponding: true
    orcid: 0009-0007-3416-7692
    email: S.Rasti@tue.nl
    affiliations:
      - name: Eindhoven University of Technology
        department: Industrial Engineering and Innovation Sciences
        address: Den Dolech 2, 5600 MB, Eindhoven
        city: Eindhoven
  - name: Krist Vaesen
    orcid: 0000-0002-7496-7463
    email: k.vaesen@tue.nl
    affiliations:
      - name: Eindhoven University of Technology
        department: Industrial Engineering and Innovation Sciences
        address: Den Dolech 2, 5600 MB, Eindhoven
        city: Eindhoven     
  - name: Daniel Lakens
    orcid: 0000-0002-8393-5316
    email: D.Lakens@tue.nl
    affiliations:
      - name: Eindhoven University of Technology
        department: Industrial Engineering and Innovation Sciences
        address: Den Dolech 2, 5600 MB, Eindhoven
        city: Eindhoven
floatsintext: true
execute: 
  echo: false
  message: false
  warning: false
format:
  apaquarto-typst:
    a4paper: true
editor_options: 
  chunk_output_type: console
---

```{r}
#| include: false
#| label: load_data_and_function


library(dplyr)
library(ggplot2)
library(psych)
library(FSA)
library(tidyr)
library(see)
library(stringr)
library(cowplot)
library(forcats)
library(scales)
library(gridExtra)
library(tibble)
library(forcats)
library(eulerr)
library(flextable)

dat<- readRDS("final_clean_dat.rds")
dat_sjr<- readRDS("dat_sjr.rds")
bigauthor_performance_5_15<- readRDS("bigauthor_performance_5_15.rds")
bigauthor_performance_sjr5_15<- readRDS("bigauthor_performance_sjr5_15.rds")
bigauthor_performance_5_25<- readRDS("bigauthor_performance_5_25.rds")
bigauthor_performance_sjr5_25<- readRDS("bigauthor_performance_sjr5_25.rds")
dunn_five<- readRDS("dunn_five.rds")
dunn_ten<- readRDS("dunn_ten.rds")
dunn_fif<- readRDS("dunn_fif.rds")

```

## Data Preprocessing

After retrieving data from the OpenAlex snapshot, duplicated records were removed in two stages. We started with duplicates in OpenAlex identifiers (oa_id) and then identified the remaining duplicates based on a combination of DOI, publication date, journal name, volume, issue, and page number.

Next, we removed the records outside of the time period January 1, 1975, and September 15, 2024. We only retained records classified as journal articles and written in English. To further ensure language consistency, we removed records with non-ASCII characters in their title.

To calculate the number of authors per article, we counted unique OpenAlex author identifiers associated with each record. We also calculated a time-difference variable to later compute date-corrected citation counts. This variable was calculated as the number of days between the publication date and the data download date (September 14, 2024), with same-day publications set to a minimum value of one day to avoid zero values.

To focus the dataset on psychology-related research, automated filtering steps were applied based on article titles, journal names, and ISSNs.

After removing obvious non-article content (i.e., acknowledgement, reviewer list, and achievement), we manually inspected 800 randomly selected records in four installments of 200. For each installment, titles and journal names were reviewed to identify irrelevant content. Identified keywords were removed from the dataset before proceeding to the next installment. The final list of keywords used for cleaning is provided below.


| **Section** | **Keywords** | 
|------:|:---------------------------------------------------:| 
| Title | Essay; Symposium; Table of Contents; Proceedings; Annual Meeting; Blockchain; Bug; Temporal Network; Handbook; Conference; Control System; Poetry; Dance; Update on; Machine Learning; Nuclear; Physics; Portfolio; Solar Power; Epilogue; Opening; Book Review; Commentary; Reporting Guideline; Editorial; Nursing; Publication Information; Sibling Designs; Airfoil; Meeting and Workshops; Correction to | 
| Journal name | History; Software; Acoustics; Surgery; Tourism; Chemistry; Robotics; Physical;Entrepreneurial Business; Computer Science; Environmental; Pharmacology; Signal Processing; Electronic; Nutrition; Engineering; Anthropology; Energy; Safety Progress; Mathematics; Philosophy; Nursing; Pediatrics; Information Technology; Physics; Medicine; Law; Criminology; Immunology; Marketing; Finance; Transportation; Operations Research; Medical Ethics; Biology | 
| ISSN | 1073-1911; 0022-0418; 1356-5028; 1440-7833; 0894-069X; 0013-7545; 1940-9052; 1063-5157; 0042-8469; 1327-9556; 1660-9336; 0127-9696; 1470-5427 |

: Keywords used for the first round {#tbl-key-1 style= "text-align: justify" } 


```{r}
#| eval: false
#| include: false

tbl_1<- tibble("Section" = c("Title", "Journal name", "ISSN"),
                   "Keywords" = list(c("Essay", "symposium", "table of content", "proceedings", "annual meeting", "Blockchain", "Bug", "Temporal Network", "Handbook", "Conference", "control system", "Poetry", "Dance", "update on", "Machine Learning", "NUCLEAR", "PHYSICS", "portfolio", "Solar Power", "Epilogue", "oppening", "Book Review", "COMMENTARY", "Reporting Guideline", "editorial", "nursing", "Publication Information","Sibling Designs", "airfoil", "Meeting and Workshops", "Correction to"), c("History", "software", "Eos", "Acoustics", "Surgery", "Tourism", "chemistry", "Robotics", "Physical","Entrepreneurial Business", "ACM SIGCSE Bulletin", "computer science", "Environmental", "Pharmacology","Metaphilosophy", "Signal Processing", "Electronic", "Nutrition", "Canadian Studies", "Style", "Fashion", "Entomology", "Ethnology", "Engineering", "Gas", "Critical Care", "Anthropolog", "art", "Energy Conversion", "Safety Progress", "Mathematic", "Machine Learning", "Revista eureka", "BMJ","IT services", "Deleted Journal", "Philosophy", "auto world", "National Academy of Sciences", "Choice Reviews Online","Hotline", "Economic", "Nursing", "Mobilities", "Conference", "Maska", "Utility Computing", "Green Computing", "theatre", "IEEE", "Pediatrics", "Information Technology", "Tissue", "Ergonomics", "Industry Applications", "Agrosearch", "Discourse", "Cybernetics", "Accounting" ,"Infection", "The Monist", "A I I E Transactions","Molecular", "Sports", "nonmunji", "Linguistica e filologia", "Music", "DergiPark", "Acta Medica", "Trade", "Synthesiology", "Aerospace", "musik", "Marketing", "Human Rights", "Dialysis", "Kairaranga", "Disaster", "Fuzzy", "Legal", "NUCLEAR", "Operations Research", "BMC", "English", "Literacy", "Information Science", "Trafficking","Planner", "Experimental Biology", "Airports", "NASSP", "Medical Ethics", "Complexity", "Medical Herald", "Social Work","Optical", "Movement Science", "soft Computing", "law Journal", "Fire", "Shock", "Vinnytsia", "Linguistica", "biochem", "Applied Probability", "Physics", "plant Science", "Parks", "Nephrology", "techtrends", "Dental", "Fuel", "criminology","Training", "Verbal", "Internal Medicine", "St Tikhons University Review", "Petroleum", "CORAK", "Teachers College", "Agricultur", "Lawyer", "Orthopt", "information systems", "Finance Review", "Air transport", "Orthopaedic", "Medicine & Biology","Obstetrics", "Intelligent Systems", "Transportation Research", "Urology", "dialectica", "JWST Proposal. Cycle 1", "Immunology"), c("1073-1911", "0022-0418", "1356-5028", "1440-7833", "0894-069X", "0013-7545", "1940-9052", "1063-5157", "0042-8469", "1327-9556", "1660-9336","0127-9696", "1470-5427") ))


flextable(tbl_1)|> bold(part = "header")
```




When we manually read the abstacts for the qualitative section, we added the following. keywords for article titles and journal names to remove remaining non-relevant content. Case-sensitive filters were applied for identified acronyms that were associated with non-psychology domains (i.e, HIV, COPD, serum, BMI, IPCC). A small number of records were also removed based on explicit OpenAlex identifiers identified during manual screening.



| **Section** | **Keywords** | 
|------:|:---------------------------------------------------:|  
| Title | correction; Book Notes; Day-by Day; Respiratory; Cover-Chewing; daytime napping; immune protection; CSCL System; Poster Session; colonial legacy; Cardiopulmonary; blood disorders; DMD patients; Upper Limb; About the Contributors; acousto-mechanical; grid computing; ventilation; cyberinfrastructure; PRO-TECT; geospatial; interprofessional medication; Phenotypic; artery bypass; Madagascar; metabolomics; aesthetic surg; endometrial; tertiary care; deflagration; Temparature; Temperature; nano-material; Diffusion; Infection; transportation; tuberculosis; Photographic; Vitreoretinopathy; hybrid mixtures; Prophylactic; Abstracts; lightcurves; ape decline; fibrosis; AQUA; primate extinction; particle; ISOCAM; diabetes; Stopwatch; genetics gap; Blood Collection; muscular dystrophy; Symbolic universes; Decarboxylase; ERA Registry; molecular; Flow System; antioxidant; autopsy; Natural gas; OpenModelica; geological; Nanotube; ape extinction; Arthritis; Cardiovascular; genomic epidemiology; Stem Cell; atrophy; debris disk; bioinformatics; Antibodies; aortic; Telepresence; narcolepsy; Traumatic Brain Injury; Hypoferremia; Stroke; oncology; Galaxy; Metabolit; harmonization; versatility; ivory; Ecology; motor disorder; Cardiac pacing; Edible Insects; entomology; gas gauge; endangered species; hepatitis; Sydenham Chorea; Pollinator; dialysis; Biomarkers | 
| Journal name | pac; oncology; APS | 
| OpenAlex identifier | https://openalex.org/W4382936650; https://openalex.org/W4200564330; https://openalex.org/W4286762924; https://openalex.org/W3097713271; https://openalex.org/W1992360116; https://openalex.org/W4312679429; https://openalex.org/W3215287579; https://openalex.org/W3043317701; https://openalex.org/W1967120130; https://openalex.org/W3203418161; https://openalex.org/W4282915658; https://openalex.org/W4391495193; https://openalex.org/W2542228716; https://openalex.org/W3196418672; https://openalex.org/W2026532911; https://openalex.org/W4400112743; https://openalex.org/W1514933037; https://openalex.org/W2055798093; https://openalex.org/W2285173204; https://openalex.org/W4220867049; https://openalex.org/W3159009895; https://openalex.org/W2325257031; https://openalex.org/W2795224003; https://openalex.org/W3205560381; https://openalex.org/W2274190439; https://openalex.org/W2943251031; https://openalex.org/W4388728636; https://openalex.org/W2985950284; https://openalex.org/W2591445343 |

: Keywords used for the second round {#tbl-key-2 style= "text-align: justify"} 


\newpage

## Sensitivity Analyses

This section contains the sensitivity analyses and robustness checks corresponding to each result presented in the manuscript. 

### Choosing 20 as a threshold for large teams in qualitative analysis

We used Dunn test to compare whether the mean rank of any two groups are different for total citation counts and used Benjamini-Hochburg adjustment [cite] to control for multiple comparisons {*side note: I also did it for second year citation*}. We then counted the number of times each author group significantly ($\alpha<0.05$) had higher ( *wins* ) and lower ( *losses* ) mean rank citation than the compared group. Across different group size definitions, we found that the groups with 20 or more authors consistently have more overall score (*wins* - *losses*) than smaller group. We therefore, used 20 as the threshold for large teams for qualitative analysis.

```{r}
#| label: tbl-dunn
#| echo: false
#| message: false
#| warning: false
#| cache: true
#| tbl-cap: Rank ordering groups of authors across different team size definition based on their performance in Dunn test
#| layout-ncol: 2
#| disable-apaquarto-processing: true


dunn_summary_five <- dunn_five$res |>
  filter(P.adj < 0.05) |>
  mutate(winner = ifelse(Z > 0, sub(" - .*", "", Comparison),
                         sub(".* - ", "", Comparison)),
         loser  = ifelse(Z > 0, sub(".* - ", "", Comparison),
                         sub(" - .*", "", Comparison)))


group_scores_five <- dunn_summary_five |>
  count(winner, name = "wins")


group_losses_five <- dunn_summary_five |>
  count(loser, name = "losses")


ranking_five <- full_join(group_scores_five, group_losses_five, by = c("winner" = "loser")) |>
  rename(group = winner) |>
  mutate(wins = replace_na(wins, 0),
         losses = replace_na(losses, 0),
         overall = wins - losses) |>
  arrange(desc(overall))


dunn_summary_ten <- dunn_ten$res |>
  filter(P.adj < 0.05) |>
  mutate(winner = ifelse(Z > 0, sub(" - .*", "", Comparison),
                         sub(".* - ", "", Comparison)),
         loser  = ifelse(Z > 0, sub(".* - ", "", Comparison),
                         sub(" - .*", "", Comparison)))


group_scores_ten <- dunn_summary_ten |>
  count(winner, name = "wins")


group_losses_ten <- dunn_summary_ten |>
  count(loser, name = "losses")


ranking_ten <- full_join(group_scores_ten, group_losses_ten, by = c("winner" = "loser")) |>
  rename(group = winner) |>
  mutate(wins = replace_na(wins, 0),
         losses = replace_na(losses, 0),
         overall = wins - losses) |>
  arrange(desc(overall))


dunn_summary_fif <- dunn_fif$res |>
  filter(P.adj < 0.05) |>
  mutate(winner = ifelse(Z > 0, sub(" - .*", "", Comparison),
                         sub(".* - ", "", Comparison)),
         loser  = ifelse(Z > 0, sub(".* - ", "", Comparison),
                         sub(" - .*", "", Comparison)))


group_scores_fif <- dunn_summary_fif |>
  count(winner, name = "wins")


group_losses_fif <- dunn_summary_fif |>
  count(loser, name = "losses")


ranking_fif <- full_join(group_scores_fif, group_losses_fif, by = c("winner" = "loser")) |>
  rename(group = winner) |>
  mutate(wins = replace_na(wins, 0),
         losses = replace_na(losses, 0),
         overall = wins - losses) |>
  arrange(desc(overall))



flextable(ranking_ten) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")
flextable(ranking_five) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")
flextable(ranking_fif) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")



```


### Large-team science is an increasing phenomenon

Regardless of the definition of team size, papers with larger team size have grown dramatically compared to papers with smaller team size.

```{r}
#| label: fig-author-trend-five
#| fig-cap: "Growth of large-team papers in groups of five"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 10
#| cache: true

pal <- c("#023743FF","#72874EFF","#476F84FF","#A4BED5FF","#A40000FF",
         "#453947FF","#774762FF","#BA6E1DFF","#D6BB3BFF","#755028FF",
         "#205F4BFF","#913914FF","#585854FF","#F0A430FF","#007E2FFF",
         "#768048FF","#800000FF","#1B3A54FF","#16317DFF","#FFCD12FF",
         "#B86092FF","#721B3EFF","#00B7A7FF","#F2DD78FF","#FED789FF")

dat |>
  mutate(pubyear = as.integer(format(as.Date(pubdate), "%Y"))) |>
  ggplot(aes(x = pubyear, color = author_group_five)) +
  geom_density(adjust = 2, linewidth = 1.2) +
  geom_vline(xintercept=c(2013,2023), linetype="dashed", colour = "darkred")+
  facet_wrap(~ author_group_five, axes = "all") +
  scale_color_manual(values = pal, guide = "none") +
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  xlab("Publication year")+
  ylab("Density")
```

```{r}
#| label: fig-author-trend-fif
#| fig-cap: "Growth of large-team papers in groups of fifteen"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 7
#| cache: true

pal <- c("#023743FF","#72874EFF","#476F84FF","#A4BED5FF","#A40000FF",
         "#453947FF","#774762FF","#BA6E1DFF","#D6BB3BFF","#755028FF",
         "#205F4BFF","#913914FF","#585854FF","#F0A430FF","#007E2FFF",
         "#768048FF","#800000FF","#1B3A54FF","#16317DFF","#FFCD12FF",
         "#B86092FF","#721B3EFF","#00B7A7FF","#F2DD78FF","#FED789FF")

dat |>
  mutate(pubyear = as.integer(format(as.Date(pubdate), "%Y"))) |>
  ggplot(aes(x = pubyear, color = author_group_fifteen)) +
  geom_density(adjust = 2, linewidth = 1.2) +
  geom_vline(xintercept=c(2013,2023), linetype="dashed", colour = "darkred")+
  facet_wrap(~ author_group_fifteen, axes = "all") +
  scale_color_manual(values = pal, guide = "none") +
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  xlab("Publication year")+
  ylab("Density")
```

### Larger teams receive more citations

Across different measures of citation (i.e., total citation, 2-year-citation, and date-corrected citation) and different definitions of team size, the mean and median for larger teams increase relatively stably until 55 authors and then experience fluctuations.

```{r}
#| label: fig-des-citation-1
#| fig-cap: "Team size of five and total citation counts"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true

dat |>
  group_by(author_group_five) |>
  ggplot(aes(x = author_group_five, y = citation)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "Total citation count")

```

```{r}
#| label: fig-des-citation-2
#| fig-cap: "Team size of five and second-year citation counts"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true

dat |>
  group_by(author_group_five) |>
  ggplot(aes(x = author_group_five, y = citation_2y)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "Second-year citation count")

```

```{r}
#| label: fig-des-citation-3
#| fig-cap: "Team size of five and date-corrected citation counts"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true


dat |>
  group_by(author_group_five) |>
  ggplot(aes(x = author_group_five, y = corr_citation)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "Date-corrected citation count")

```

```{r}
#| label: fig-des-citation
#| fig-cap: "Team size of ten and total citation counts"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true

dat |>
  group_by(author_group_ten) |>
  ggplot(aes(x = author_group_ten, y = citation)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "Total citation count")

```

```{r}
#| label: fig-des-citation-10
#| fig-cap: "Team size of ten and date-corrected citation counts"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true


dat |>
  group_by(author_group_ten) |>
  ggplot(aes(x = author_group_ten, y = corr_citation)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "Date-corrected citation count")

```

```{r}
#| label: fig-des-citation-11
#| fig-cap: "Team size of fifteen and total citation counts"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true

dat |>
  group_by(author_group_five) |>
  ggplot(aes(x = author_group_fifteen, y = citation)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "Total citation count")

```

```{r}
#| label: fig-des-citation-22
#| fig-cap: "Team size of fifteen and second-year citation counts"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true

dat |>
  group_by(author_group_five) |>
  ggplot(aes(x = author_group_fifteen, y = citation_2y)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "Second-year citation count")

```

```{r}
#| label: fig-des-citation-33
#| fig-cap: "Team size of fifteen and date-corrected citation counts"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true


dat |>
  group_by(author_group_five) |>
  ggplot(aes(x = author_group_fifteen, y = corr_citation)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "Date-corrected citation count")

```

Tables below show the descriptive results for different citation measures across different team-size definitions.

::: {#tbl-des-1 style= "text-align: justify"}

```{r}
#| label: des-1
#| echo: false
#| message: false
#| warning: false
#| tbl-cap: Descriptive statistics for groups of five
#| cache: true


des<- dat|>
  rename("Total citation" = "citation", "2-year-citation" = "citation_2y", "Time-corrected citation" = "corr_citation", "Group size of 5" = "author_group_five")|>
  group_by(`Group size of 5`)|>
  summarise(n=n(),
            across(c(`Total citation`, `2-year-citation`, `Time-corrected citation`), list( mean = ~round(mean(.x), 2), sd = ~round(sd(.x), 2), median = ~round(median(.x), 2))))

flextable(des) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")
  
```

Descriptive statistics of citation measures by team size (groups of five authors) 
:::

::: {#tbl-des-2 style= "text-align: justify"}

```{r}
#| label: des-2
#| echo: false
#| message: false
#| warning: false
#| cache: true
#| tbl-cap: Descriptive statistics for groups of ten

des2<- dat|>
  rename("Total citation" = "citation", "2-year-citation" = "citation_2y", "Time-corrected citation" = "corr_citation", "Group size of 10" = "author_group_ten")|>
  group_by(`Group size of 10`)|>
  summarise(n=n(),
            across(c(`Total citation`, `2-year-citation`, `Time-corrected citation`), list( mean = ~round(mean(.x), 2), sd = ~round(sd(.x), 2), median = ~round(median(.x), 2))))


flextable(des2) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")

```

Descriptive statistics of citation measures by team size (groups of ten authors) 
:::

::: {#tbl-des-3 style= "text-align: justify"}

```{r}
#| label: des-tbl-3
#| echo: false
#| message: false
#| warning: false
#| cache: true
#| tbl-cap: Descriptive statistics for groups of fifteen

des3<- dat|>
  rename("Total citation" = "citation", "2-year-citation" = "citation_2y", "Time-corrected citation" = "corr_citation", "Group size of 15" = "author_group_fifteen")|>
  group_by(`Group size of 15`)|>
  summarise(n=n(),
            across(c(`Total citation`, `2-year-citation`, `Time-corrected citation`), list( mean = ~round(mean(.x), 2), sd = ~round(sd(.x), 2), median = ~round(median(.x), 2))))

flextable(des3) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")|> set_caption(caption = "Descriptive statistics of diffenent citation measures for groups size of fifteen")
```

Descriptive statistics of citation measures by team size (groups of fifteen authors) 
:::

### Larger teams are published in more prestigious journals

Team size definition also did not impact the result on larger teams being published in higher rank journals.

```{r}
#| label: fig-des-journal-1
#| fig-cap: "Team size of five and journals’ prestige"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true

dat_sjr |>
  group_by(author_group_five) |>
  ggplot(aes(x = author_group_five, y = SJR)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "SJR")
```

```{r}
#| label: fig-des-journal-11
#| fig-cap: "Team size of fifteen and journals’ prestige"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true

dat_sjr |>
  group_by(author_group_fifteen) |>
  ggplot(aes(x = author_group_fifteen, y = SJR)) +
  geom_boxplot(outliers = FALSE, fill = "#A4BED5FF") +
  stat_summary(
    fun = mean, geom = "point", color = "#800000FF", size = 2
  ) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x = "Author groups", y= "SJR")
```

```{r}
#| label: tbl-4
#| echo: false
#| message: false
#| warning: false
#| cache: true
#| tbl-cap: Descriptive statistics of journal ranking by team size
#| layout-ncol: 2
#| layout-nrow: 2


des4<- dat_sjr|>
  rename("SCImago Journal Rank" = "SJR", "Group size of 5" = "author_group_five")|>
  group_by(`Group size of 5`)|>
  summarise(n=n(),
            across(c(`SCImago Journal Rank`), list( mean = ~round(mean(.x), 2), sd = ~round(sd(.x), 2), median = ~round(median(.x), 2))))

des5<- dat_sjr|>
  rename("SCImago Journal Rank" = "SJR", "Group size of 10" = "author_group_ten")|>
  group_by(`Group size of 10`)|>
  summarise(n=n(),
            across(c(`SCImago Journal Rank`), list( mean = ~round(mean(.x), 2), sd = ~round(sd(.x), 2), median = ~round(median(.x), 2))))

des6<- dat_sjr|>
  rename("SCImago Journal Rank" = "SJR", "Group size of 15" = "author_group_fifteen")|>
  group_by(`Group size of 15`)|>
  summarise(n=n(),
            across(c(`SCImago Journal Rank`), list( mean = ~round(mean(.x), 2), sd = ~round(sd(.x), 2), median = ~round(median(.x), 2))))


flextable(des5) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")
flextable(des4) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")
flextable(des6) |>separate_header()|>align(align = "center", part = "all")|>autofit()|>bold(part = "header")


```

### Papers authored by larger teams are more likely to be published in higher impact journals, and receive more citations

```{r}
mm_b<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(citation), 2), median = median(citation))

x <- mm_b$median

com_perc<- dat |>
  mutate(author_bin = if_else(n_author < 20, "<20 authors", ">=20 authors")) |>
  group_by(author_bin) |>
  summarise(
    n = sum(!is.na(citation)),
    percentile = 100 * mean(citation <= x, na.rm = TRUE)
  )

mm_b2<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(citation_2y), 2), median = median(citation_2y))

x <- mm_b2$median

com_perc2<- dat |>
  mutate(author_bin = if_else(n_author < 20, "<20 authors", ">=20 authors")) |>
  group_by(author_bin) |>
  summarise(
    n = sum(!is.na(citation_2y)),
    percentile = 100 * mean(citation_2y <= x, na.rm = TRUE)
  )


mm_b_cor<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(corr_citation), 2), median = median(corr_citation))

x <- mm_b_cor$median

com_perc_cor<- dat |>
  mutate(author_bin = if_else(n_author < 20, "<20 authors", ">=20 authors")) |>
  group_by(author_bin) |>
  summarise(
    n = sum(!is.na(corr_citation)),
    percentile = 100 * mean(corr_citation <= x, na.rm = TRUE)
  )



mm_sjr<- dat_sjr|> filter(n_author>=20)|> summarise(mean = round(mean(SJR), 2), median = median(SJR))

y <- mm_sjr$median

com_perc_sjr<- dat_sjr |>
  mutate(author_bin = if_else(n_author < 20, "<20 authors", ">=20 authors")) |>
  group_by(author_bin) |>
  summarise(
    n = sum(!is.na(SJR)),
    percentile = 100 * mean(SJR <= y, na.rm = TRUE)
  )
```

Regardless of the definition of impact (i.e., total citation, 2-year citation, date-corrected citation, journal rank), pursuing impact in a smaller team is a risky strategy. To have a chance to outperform the median total citation, 2-year citation, date-corrected citation, and SJR of larger author papers, small teams have to be at the top `r 100 - round(com_perc$percentile[1], 2)`th, `r 100 - round(com_perc2$percentile[1], 2)`th, `r 100 - round(com_perc_cor$percentile[1], 2)`th, and `r 100 - round(com_perc_sjr$percentile[1], 2)`th percentile respectively.

```{r}
#| label: fig-percentile-five-1
#| fig-cap: "Percentiles of total citation and second-year citation metrics based on group size of 5"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| layout-nrow: 2
#| fig-subcap: 
#|      - "Groups of five - Total citation"
#|      - "Groups of five - Second-year citation"
#| fig-width: 8
#| fig-height: 4
#| cache: true

mm_b<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(citation), 2), median = median(citation))
mm_b2<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(citation_2y), 2), median = median(citation_2y))



dat|>filter(n_author<20)|>group_by(author_group_five)|> summarise(value= quantile(citation, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_five, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "Total citation")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_b$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_b$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))


dat|>filter(n_author<20)|>group_by(author_group_five)|> summarise(value= quantile(citation_2y, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_five, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "Second-year citation")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_b2$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_b2$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))


```

```{r}
#| label: fig-percentile-five-2
#| fig-cap: "Percentiles of date-corrected citation metrics and SJR based on group size of 5"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| layout-nrow: 2
#| fig-subcap: 
#|      - "Groups of five - Date-corrected citation"
#|      - "Groups of five - SJR"
#| fig-width: 8
#| fig-height: 4
#| cache: true


mm_b_cor<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(corr_citation), 2), median = median(corr_citation))
mm_sjr<- dat_sjr|> filter(n_author>=20)|> summarise(mean = round(mean(SJR), 2), median = median(SJR))

dat|>filter(n_author<20)|>group_by(author_group_five)|> summarise(value= quantile(corr_citation, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_five, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "Second-year citation")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_b_cor$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_b_cor$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))



dat_sjr|>filter(n_author<20)|>group_by(author_group_five)|> summarise(value= quantile(SJR, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_five, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "SJR")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_sjr$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_sjr$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))

```

*I think I can remove the remaining figures in this part, because 1-5 is similar in all and the remaining group is not adding much. what do you think?*


```{r}
#| label: fig-percentile-ten
#| fig-cap: "Percentiles of total citation and date corrected and SJR based on group size of 10"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| layout-nrow: 2
#| fig-subcap: 
#|      - "Groups of ten - Total citation"
#|      - "Groups of ten - Date-corrected citation"
#| fig-width: 8
#| fig-height: 4
#| cache: true

mm_b<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(citation), 2), median = median(citation))
mm_b_cor<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(corr_citation), 2), median = median(corr_citation))


dat|>filter(n_author<20)|>group_by(author_group_ten)|> summarise(value= quantile(citation, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_ten, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "Second-year citation")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_b$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_b$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))


dat|>filter(n_author<20)|>group_by(author_group_ten)|> summarise(value= quantile(corr_citation, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_ten, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "Second-year citation")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_b_cor$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_b_cor$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))

```

```{r}
#| label: fig-percentile-fif
#| fig-cap: "Percentiles of total citation and second-year citation metrics based on group size of 15"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| layout-nrow: 2
#| fig-subcap: 
#|      - "Groups of fifteen - Total citation"
#|      - "Groups of fifteen - Second-year citation"
#| fig-width: 8
#| fig-height: 4
#| cache: true

mm_b<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(citation), 2), median = median(citation))
mm_b2<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(citation_2y), 2), median = median(citation_2y))


dat|>filter(n_author<20)|>group_by(author_group_fifteen)|> summarise(value= quantile(citation, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_fifteen, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "Total citation")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_b$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_b$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))


dat|>filter(n_author<20)|>group_by(author_group_fifteen)|> summarise(value= quantile(citation_2y, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_fifteen, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "Second-year citation")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_b2$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_b2$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))
```

```{r}
#| label: fig-percentile-fif-2
#| fig-cap: "Percentiles of date-corrected citation metrics and SJR based on group size of 15"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| layout-nrow: 2
#| fig-subcap: 
#|      - "Groups of fifteen - Date-corrected citation"
#|      - "Groups of fifteen - SJR"
#| fig-width: 8
#| fig-height: 4
#| cache: true

mm_b_cor<- dat|> filter(n_author>=20)|> summarise(mean = round(mean(corr_citation), 2), median = median(corr_citation))
mm_sjr<- dat_sjr|> filter(n_author>=20)|> summarise(mean = round(mean(SJR), 2), median = median(SJR))


dat|>filter(n_author<20)|>group_by(author_group_fifteen)|> summarise(value= quantile(corr_citation, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_fifteen, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "Second-year citation")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_b_cor$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_b_cor$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))


dat_sjr|>filter(n_author<20)|>group_by(author_group_fifteen)|> summarise(value= quantile(SJR, c(.7, .8, .90, .99)))|> mutate(percentile = as.factor(c(.7, .8,.9,.99)))|>
  ggplot(aes(x=author_group_fifteen, y = value, color = percentile))+
  geom_point(size= 2)+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))+
  labs(x= "Author group", y= "SJR")+
  scale_color_manual(values = c("#2f4b7c", "#d45087", "#f95d6a", "#F0A430"))+
  geom_hline(aes(yintercept = mm_sjr$median, linetype = "Median"), color = "darkred", size = 1 )+
  geom_hline(aes(yintercept = mm_sjr$mean, linetype = "Mean"), color = "darkred", size = 1.2)+
  scale_linetype_manual(name = "Large team values", values = c("dotted","solid"))

```

### Large-team papers are consistently authors’ more successful publications

```{r}
#| warning: false
#| message: false
#| echo: false
#| cache: true


df_long_15 <- bigauthor_performance_5_15 |>
  select(citation_2y_median_small, citation_2y_median_big,
         citation_median_small,   citation_median_big,
         corr_citation_median_small, corr_citation_median_big) |>
  pivot_longer(
    cols = everything(),
    names_to = c("metric", "team"),
    names_pattern = "(.+?)_(small|big)$",
    values_to = "value"
  ) |>
  mutate(
    team = factor(team, levels = c("small","big"),
                  labels = c("Small projects","Big projects"))
  )


df_long2_15 <- bigauthor_performance_sjr5_25 |>
  select(SJR_median_small, SJR_median_big) |>
  pivot_longer(
    cols = everything(),
    names_to = c("metric", "team"),
    names_pattern = "(.+?)_(small|big)$",
    values_to = "value"
  ) |>
  mutate(
    team = factor(team, levels = c("small","big"),
                  labels = c("Small projects","Big projects"))
  )


descriptive_15<- df_long_15|> filter(metric == "citation_2y_median")|>group_by(team)|> summarise(mean = mean(value),sd = sd(value))
unstand_ES_15<- round(descriptive_15$mean[2]-descriptive_15$mean[1], digits = 2)

descriptive_citation_15<- df_long_15|> filter(metric == "citation_median")|>group_by(team)|> summarise(mean = mean(value),sd = sd(value))
unstand_ES_citation_15<- round(descriptive_citation_15$mean[2]-descriptive_citation_15$mean[1], digits = 2)

descriptive_corr_15<- df_long_15|> filter(metric == "corr_citation_median")|>group_by(team)|> summarise(mean = mean(value),sd = sd(value))
unstand_ES_corr_15<- round(descriptive_corr_15$mean[2]-descriptive_corr_15$mean[1], digits = 2)

descriptive2_15<-df_long2_15|> filter(metric == "SJR_median")|>group_by(team)|> summarise(mean = mean(value),sd = sd(value))
unstand_ES2_15<- round(descriptive2_15$mean[2]-descriptive2_15$mean[1], digits = 2)

```


```{r}
#| warning: false
#| message: false
#| echo: false
#| cache: true


df_long <- bigauthor_performance_5_25 |>
  select(citation_2y_median_small, citation_2y_median_big,
         citation_median_small,   citation_median_big,
         corr_citation_median_small, corr_citation_median_big) |>
  pivot_longer(
    cols = everything(),
    names_to = c("metric", "team"),
    names_pattern = "(.+?)_(small|big)$",
    values_to = "value"
  ) |>
  mutate(
    team = factor(team, levels = c("small","big"),
                  labels = c("Small projects","Big projects"))
  )


df_long2 <- bigauthor_performance_sjr5_25 |>
  select(SJR_median_small, SJR_median_big) |>
  pivot_longer(
    cols = everything(),
    names_to = c("metric", "team"),
    names_pattern = "(.+?)_(small|big)$",
    values_to = "value"
  ) |>
  mutate(
    team = factor(team, levels = c("small","big"),
                  labels = c("Small projects","Big projects"))
  )


descriptive<- df_long|> filter(metric == "citation_2y_median")|>group_by(team)|> summarise(mean = mean(value),sd = sd(value))
unstand_ES<- round(descriptive$mean[2]-descriptive$mean[1], digits = 2)

descriptive_citation<- df_long|> filter(metric == "citation_median")|>group_by(team)|> summarise(mean = mean(value),sd = sd(value))
unstand_ES_citation<- round(descriptive_citation$mean[2]-descriptive_citation$mean[1], digits = 2)

descriptive_corr<- df_long|> filter(metric == "corr_citation_median")|>group_by(team)|> summarise(mean = mean(value),sd = sd(value))
unstand_ES_corr<- round(descriptive_corr$mean[2]-descriptive_corr$mean[1], digits = 2)

descriptive2<-df_long2|> filter(metric == "SJR_median")|>group_by(team)|> summarise(mean = mean(value),sd = sd(value))
unstand_ES2<- round(descriptive2$mean[2]-descriptive2$mean[1], digits = 2)

```

Regardless of the definition for large teams (i.e., number of authors more than 15 and 25), larger teams papers are consistently authors’ more successful publications. For author group of $\ge$15 of researchers, median citation of large-team publication on average, are `r unstand_ES_15` higher on their second year compared to the smaller team publication. This number for total citation and publication-date–corrected citation are `r unstand_ES_citation_15` and `r unstand_ES_corr_15` respectively. Similarly, the median SJR of large-team publication of researchers is, on average `r unstand_ES2_15` higher than their smaller group publications. For author group of $\ge$25 of researchers, these differences are `r unstand_ES` for second-year citation, `r unstand_ES_citation` for total citation, `r unstand_ES_corr` for publication-date–corrected citation, and `r unstand_ES2` for the journal ranking. 
{*note: ignore the 25 group citation ones, there is a problem with the grouping them, so I fix that at the weekend.*}

```{r}
#| label: fig-single-author-perfo-15
#| fig-cap: " Performance of small-team project papers compared to large-team project papers of the same author"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true


df_long_mix_15<- rbind(df_long_15, df_long2_15)


metric_labs <- c(
  citation_2y_median      = "2-year citations",
  citation_median         = "Total citations",
  corr_citation_median    = "Date-corrected citations",
  SJR_median              = "SCImago Journal Rank"
)

ggplot(df_long_mix_15, aes(x = team, y = value, fill = team)) +
  geom_boxplot(outliers = FALSE) +
  facet_wrap(~ metric, labeller = as_labeller(metric_labs), scales = "free_y") +
  labs(x = NULL, y = NULL) +
  theme_classic() +
  theme(axis.text.x=element_blank())+
  scale_fill_manual(values = c("#007E2F", "#BA6E1D"))

  
```


```{r}
#| label: fig-single-author-perfo
#| fig-cap: " Performance of small-team project papers compared to large-team project papers of the same author"
#| warning: false
#| message: false
#| echo: false
#| fig-align: center
#| fig-width: 8
#| fig-height: 4
#| cache: true


df_long_mix<- rbind(df_long, df_long2)


metric_labs <- c(
  citation_2y_median      = "2-year citations",
  citation_median         = "Total citations",
  corr_citation_median    = "Date-corrected citations",
  SJR_median              = "SCImago Journal Rank"
)

ggplot(df_long_mix, aes(x = team, y = value, fill = team)) +
  geom_boxplot(outliers = FALSE) +
  facet_wrap(~ metric, labeller = as_labeller(metric_labs), scales = "free_y") +
  labs(x = NULL, y = NULL) +
  theme_classic() +
  theme(axis.text.x=element_blank())+
  scale_fill_manual(values = c("#007E2F", "#BA6E1D"))

  
```


